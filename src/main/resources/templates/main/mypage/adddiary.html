<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì¼ê¸°ì‘ì„±</title>
  <link rel="stylesheet" type="text/css" href="../../../static/css/mypage.css" th:href="@{/css/mypage.css}">
  <script>
    //ì½”ë””ë³„ì ì£¼ê¸°
    const drawStar = (target) => {
      document.querySelector(`.star span`).style.width = `${target.value * 10}%`;
    }
  </script>
</head>
<body>
<div>
  <div class="leftBar" th:insert="~{main/sidebar :: sidebar}">
  </div>
</div>
<div class="maincontent">
  <div class="introduce">
    <div id="subT">ë§ˆì´í˜ì´ì§€ > ì½”ë””ì¼ê¸°</div>
    <div>ì¼ê¸°ì‘ì„±</div>
  </div>
  <form method="post" th:object="${diaryForm}" enctype="multipart/form-data">
    <div id="diarywrite">
      <div id="diaryform">
          <div>
            <input type="hidden" id="userId" name="userId" th:value="${member.userId}">
          </div>
          <div class="formList">
            <label for="dDate">ë‚ ì§œì„ íƒ</label>
            <div>
              <input type="date" id="dDate" th:field="*{dDate}">
            </div>
            <div class="field-error" th:errors="*{dDate}">
              ì˜¤ë¥˜
            </div>
          </div>
          <div class="formList">
            <label for="dLocation">ì¥ì†Œì„ íƒ</label>
            <div id="dLocation">
              <select id="userLocation" th:field="*{dLocation1}">
                <option value="">ì‹œ/ë„ ì„ íƒ</option>
              </select>
              <select id="userLocation2" th:field="*{dLocation2}">
                <option value="">ì‹œ/êµ°/êµ¬ ì„ íƒ</option>
              </select>
            </div>
            <div class="field-error" th:errors="*{dLocation1}">
              ì˜¤ë¥˜
            </div>
          </div>
          <div class="formList">
            <label for="file">ì½”ë””</label>
            <div class="dphotoex">ì˜¤ëŠ˜ì˜ ì‚¬ì§„ì„ ë‚¨ê¸´ë‹¤ë©´ ë‹¤ìŒì— ì°¸ê³ í•˜ê¸° ì¢‹ì•„ìš”ğŸ§¡</div>
            <input type="file" id="file" name="file">
            <div class="field-error" th:errors="*{dCody}">
              ì˜¤ë¥˜
            </div>
          </div>
          <div class="formList">
            <label for="dScore">ì½”ë””ì ìˆ˜</label>
            <div>
              <span class="star">
                â˜…â˜…â˜…â˜…â˜…<span>â˜…â˜…â˜…â˜…â˜…</span>
                <input type="range" id="dScore" th:field="*{dScore}" oninput="drawStar(this)" value="1" step="2" min="0" max="10">
              </span>
            </div>
            <div>
              <textarea th:field="*{dContent}" rows="10" placeholder="ì˜¤ëŠ˜ ì½”ë””ì˜ ëŠë‚€ì ì„ ì ì–´ì£¼ì„¸ìš”"></textarea>
            </div>
          </div>
          <div>
            <input id="submitBtn" type="submit" value="ì‘ì„±">
          </div>
      </div>
    </div>
    <div id="diarycloset">
      <div class="photoex">ì½”ë””í•œ ì˜·ì„ ì²´í¬í•´ì£¼ì„¸ìš”(ìµœëŒ€ 3ê°œ)</div>
      <div class="closetcontent">
        <div class="cloth" th:each="cloth : ${clothes}">
        <input type="checkbox" name="check" th:value="${cloth.cId}"  th:field="*{dCody}">
            <div class="clothimg"><div class="clothimgdiv"><img th:src="@{${cloth.cPhotoPath}}" alt="ì˜·ì‚¬ì§„"></div></div>
            <div class="cColor" name="cColor" th:style="|background-color:'${cloth.cColor}';|">
              <div class="clothcontent">
                <div class="content">
                  <div class="clothbuy"><span th:text="${cloth.cWhereToBuy}">ìë¼</span> êµ¬ë§¤</div>
                  <div class="clothname"><span class="cName" th:text="${cloth.cName}">ì´ˆë¡ì›í”¼ìŠ¤</span></div>
                </div>
              </div>
            </div>
        </div>
      </div>
    </div>
  </form>
</div>
</body>

<script type="text/javascript" src="../../static/js/jquery-3.4.1.min.js" th:src="@{/js/jquery-3.4.1.min.js}"></script>
<script type="text/javascript" th:src="@{/js/menuactive.js}"></script>
<script src="https://code.jquery.com/jquery-3.1.0.js"></script>
<script>
<!--    $("#userLocation2").chainedTo("#userLocation");-->
        $(document).ready(function(){
          loadArea('loadParent',$(this));
        });
        $('#userLocation').on("change",function(){
          loadArea('loadChild',$(this));
        });
        function loadArea(selectedType,selectedValue){
          $.ajax({
              url: "/region/api",
              dataType: "JSON",
              method: "GET"
          }).done(function(res){
             if(selectedType == 'loadParent'){
                  $.each(res, function (index,value){
                      var hasOption=$('#userLocation option[value="'+value.parentRegion+'"]').length;
                      if(hasOption==0){
                          $('#userLocation').append('<option value="'+value.parentRegion+'">'+value.parentRegion+'</option>');
                      }
                  });
             }else if(selectedType == 'loadChild'){
                  var selectedValueText = $(selectedValue).find('option:selected').text();
                  $('#userLocation2').empty();
                  $.each(res, function (index,value){

                      if(selectedValueText==value.parentRegion){

                          $('#userLocation2').append('<option value="'+value.childRegion+'">'+value.childRegion+'</option>');
                      }
                  });
             }
          });
        }

        $(document).ready(function(){
          for(var i = 0; i<3; i++){
            $('.cName').on('dblclick', function(e){
              //alert(e.target.id);
              $('input[id=dCody1]').attr('value',e.target.id);
            });
            $('.cName').on('dblclick', function(e){
              $('input[id=dCody2]').attr('value',e.target.id);
            });
            $('.cName').on('dblclick', function(e){
              //alert(e.target.id);
              $('input[id=dCody3]').attr('value',e.target.id);
            });
          }
        });

    </script>
</html>